<html lang="en">

    <head>
        <meta charset="utf-8">
        <link rel="stylesheet" href="css/css-style.css">
        <title>ASDL IoT Datapage</title>
        <link rel="icon" href="https://www.asdl.gatech.edu/images/favicon.png">
    </head>

    <body onload="refreshCharts()">        
        <div id="large-header">
            <div id="large-header-container">
                <div id="large-wordmark"><a href="index.html"><img src="images/ASDL-Logo_Main%20Logo.svg"></a></div>
            </div>
            <div id="menu-header-container">
                <div id="web-menu">
                    <div id="small-cta">
                        <a class="menu-button" href="index.html#SensorListLink">Project List</a>
                    </div> 
                    <div id="small-spacer"></div>
                    <div id="small-spacer"></div>
                    <div id="small-cta">
                        <a class="menu-button" href="index.html#AboutLink">About Us</a>
                    </div> 
                    <div id="small-spacer"></div>
                    <div id="small-spacer"></div>
                    <div id="small-cta">
                        <a class="menu-button" href="index.html#ExtLink">External Links</a>
                    </div> 
                    <div id="small-spacer"></div>
                    <div id="small-spacer"></div>
                    <div id="small-cta">
                        <a class="menu-button" href="https://forms.office.com/Pages/ResponsePage.aspx?id=u5ghSHuuJUuLem1_Mvqgg7kibaa985pOnmfQIWOFmjNUN0VDWEkzVkFSSVAzOVJPSjA0SjU5N0M2RC4u" target="_blank">Join the Team</a>
                    </div> 
                    <div id="small-spacer"></div>
                </div>
            </div>  
        </div>




        <div id="main-container">



            <div id = "mid-buffer"></div>
            <div id="main">
                <div class="anchor" id="home"></div><h1 id="header-light">Home</h1>
                <p id="text-light">This is the Home Page for the ASDL IoT Development Project. This team is developing a series of sensors for use across multiple applications to connect Georgia Tech's campus, and more. Real-time sensor data can be found from any of the online sensors in the <b>Project List</b>. If you want to learn more about how this project works, visit the <b>About Us</b> tab.</p>
                <p id = "text-light">This is an ongoing project through Georgia Tech's Aerospace Systems Design Lab. If you are interested in becoming part of the team, reach out through the <b>Join the Team</b> button.</p>
                <p id = "text-light">This webpage, the hardware that collects its data, and its backend data processing is the work of Alex Lomis (Fall 2022 - Spring 2023).</p>
            </div>
            <div id = "mid-buffer"></div>
            <div id = "mid-buffer"></div>

            <div id="sensor-vitals-section">
                <div id="price-content">
                    <div class="anchor" id="SensorListLink"></div><h1 id="header-light-dark">Project List</h1>
                    <p id="text-light-dark" >A list of current projects and their rough purpose can be found below. Next to each sensor is a meter that shows the last time a sensor from this project posted data. This is a good metric as to whether the project is currently online. Note that sensors only update data on 10-15 minute intervals. <b>Click on a project's name</b> to view more specifics about what it does, what sensors are on it, and its recorded data.</p>
                    <div id = "mid-buffer"></div>
                    <p id="text-light-dark" >The CNES Air Quality project uses a set of five 4G-LTE connnected air quality sensors to monitor the Georgia Tech Carbon-Neutral Energy Solutions Laboratory. Click on the project to see what kind of data the sensors collect!</p>
                    <div id = "mid-buffer"></div>
                    <p id="text-light-dark" >The Building Occupancy project uses sensors across the entryways of buildings to estimate the number of people that enter and exit. This is a work-in-progress and currently only has one sensor connected (for testing purposes).</p>
                </div>


                <div id="row">
                    <div id="halftitles">
                        <div id="small-cta">
                            <a class="sensor-button" id="CNES Air Quality" type="button" href="CNES.html">CNES Air Quality</a>
                        </div>  
                    </div>
                    <div id="large-spacer"></div>
                    <div id="halftitles">
                        <div id="small-cta">
                            <a class="ping-button" type="button" id="LP1"> </a>
                        </div>

                    </div>
                </div>

                <div id="row">
                    <div id="halftitles">
                        <div id="small-cta">
                            <a class="sensor-button" type="button" href="CNES.html">Building Occupancy</a>
                        </div>  
                    </div>
                    <div id="large-spacer"></div>
                    <div id="halftitles">


                        <div id="small-cta">
                            <a class="ping-button" type="button" id="LP2"> </a>
                        </div>


                    </div>
                </div>

                <div id = "mid-buffer"></div>                
            </div>


            <!--Each ThingSpeak Chart-->
            <div id = "mid-buffer"></div>
            <div id="main">
                <div class="anchor" id="AboutLink"></div><h1 id="header-light">About the Project</h1>
                <p id="text-light">Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur.</p>
                <div id = "mid-buffer"></div>
                <h2 id="header-light"><u>SENSOR-NAME Battery</u></h2>
            </div>
            <div id = "mid-buffer"></div>



            <div id="selection-container">
                <div id="small-cta">
                    <input type="number" min="1" max="20000" value="10000" id ="chargenum" class="form-control">
                </div> 
                <div id="small-cta">
                    <a class="form-button" type="button" href="#"  onclick="updateChargeNum();event.preventDefault();">Set # Points</a>
                </div>
            </div>
            <div id = "midline"></div>

            <!--END-->

            <!--Each ThingSpeak Chart-->
            <div id = "mid-buffer"></div>
            <div id="main">
                <h2 id="header-light"><u>SENSOR-NAME Solar Panel Voltage</u></h2>
            </div>
            <div id = "mid-buffer"></div>



            <div id="selection-container">
                <div id="small-cta">
                    <input type="number" min="1" max="20000" value="10000" id ="SVnum" class="form-control">
                </div> 
                <div id="small-cta">
                    <a class="form-button" type="button" href="#"  onclick="updateSVNum();event.preventDefault();">Set # Points</a>
                </div>
            </div>
            <div id = "midline"></div>

            <!--END-->

            <!--Each ThingSpeak Chart-->
            <div id = "mid-buffer"></div>
            <div id="main">
                <h2 id="header-light"><u>SENSOR-NAME Regulator Voltage</u></h2>
            </div>
            <div id = "mid-buffer"></div>


            <div id="selection-container">
                <div id="small-cta">
                    <input type="number" min="1" max="20000" value="10000" id ="RVnum" class="form-control">
                </div> 
                <div id="small-cta">
                    <a class="form-button" type="button" href="#"  onclick="updateRVNum();event.preventDefault();">Set # Points</a>
                </div>
            </div>

            <div id = "mid-buffer"></div>
            <!--END-->


            <div id="price-container">
                <div id="price-content">
                    <div class="anchor" id="ExtLink"></div><h1 id="header-light">External Links</h1>
                </div>
                <div id="main">
                    <p id="text-light">Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur.</p>
                    <div id = "mid-buffer"></div>
                </div>
                <div id="thingspeakcharts">
                    <embed src="https://energywatch.gatech.edu/" style="width:100%; height: 500px;">
                </div>
                <div id = "mid-buffer"></div>
                <div id = "mid-buffer"></div>
            </div>

            <div id="cta">
                <a class="cta-button" href="index.html#home">Back to the Top!</a>
            </div>
        </div>

        <!-- Scripts that manage chart data points -->  
        <script>
            setInterval(refreshCharts, 10000)
            
            function refreshCharts(){
                getLastSignal("2099116", "LP1");
                getLastSignal("2099128", "LP2");
            }

            async function getLastSignal(channel, HTMLItem) {
                let file = "https://api.thingspeak.com/channels/" + channel + "/fields/1/last_data_age.txt";
                let myObject = await fetch(file);
                let myText = await myObject.text();
                var time = parseInt(myText);
                if (time < 1000){
                    str = "<i>Last Ping: T+ " + myText +"s</i>"
                } else {
                    str = "<i style=color:#EA0606;>Sensor Offline</i>"
                }
                document.getElementById(HTMLItem).innerHTML = str;
            }
        </script>
    </body>
</html>
